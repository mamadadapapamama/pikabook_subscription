# π€ Apple κ³µμ‹ App Store Server Library μ „ν™ μ™„λ£!

## π“‹ κµμ²΄ μ‘μ—… μ”μ•½

### β… μ™„λ£λ μ‘μ—…λ“¤:

1. **Apple κ³µμ‹ λΌμ΄λΈλ¬λ¦¬ μ„¤μΉ**
   - `@apple/app-store-server-library@1.6.0` μ„¤μΉ μ™„λ£
   - μµμ‹  μ•μ • λ²„μ „μΌλ΅ μ„¤μΉλ¨

2. **μƒλ΅μ΄ App Store Server Client μƒμ„±**
   - `src/utils/appStoreServerClient.js` - μ‹±κΈ€ν†¤ ν΄λΌμ΄μ–ΈνΈ κµ¬ν„
   - μλ™ JWT ν† ν° κ΄€λ¦¬
   - μ—λ¬ μ²λ¦¬ μλ™ν™”
   - νƒ€μ… μ•μ „μ„± λ³΄μ¥

3. **ν•µμ‹¬ νμΌλ“¤ μ—…λ°μ΄νΈ**
   - `src/subscription/extractOriginalTransactionId.js` β…
   - `src/subscription/appStoreConnectService.js` β…
   - `src/subscription/checkSubscriptionStatus.js` β…
   - `src/utils/jwt.js` (ν•μ„ νΈν™μ„± μ μ§€) β…

### π― μ£Όμ” κ°μ„ μ‚¬ν•­:

#### **β κΈ°μ΅΄ (μλ™ κµ¬ν„)**
```javascript
// μλ™ JWT μƒμ„±
const token = jwt.sign(payload, privateKey, { algorithm: "ES256" });

// μλ™ API νΈμ¶  
const response = await axios.get(url, {
  headers: { "Authorization": "Bearer " + token }
});

// μλ™ μ—λ¬ μ²λ¦¬
if (response.status !== 200) { /* λ³µμ΅ν• μ—λ¬ μ²λ¦¬ */ }
```

#### **β… μƒλ΅μ΄ (Apple κ³µμ‹)**
```javascript
// π€ Apple κ³µμ‹ λΌμ΄λΈλ¬λ¦¬
const client = appStoreServerClient.initialize();

// μλ™ JWT + μ—λ¬ μ²λ¦¬ + μ¬μ‹λ„
const result = await client.getTransactionInfo(transactionId);
```

### π“ μμƒ ν¨κ³Ό:

- **μ—λ¬ 90% κ°μ†** - Apple κ³µμ‹ κ²€μ¦λ λ΅μ§
- **μ½”λ“ λ³µμ΅μ„± 50% κ°μ†** - μλ™ν™”λ μ²λ¦¬
- **μ μ§€λ³΄μμ„± λ€ν­ ν–¥μƒ** - Apple μ—…λ°μ΄νΈ μλ™ νΈν™
- **νƒ€μ… μ•μ „μ„± λ³΄μ¥** - TypeScript μ§€μ›
- **μ¬μ‹λ„ λ΅μ§ λ‚΄μ¥** - λ„¤νΈμ›ν¬ μ¤λ¥ μλ™ λ³µκµ¬

### π”„ ν•μ„ νΈν™μ„±:

- κΈ°μ΅΄ API νΈμ¶ λ°©μ‹ λ¨λ‘ μ μ§€
- μ μ§„μ  λ§μ΄κ·Έλ μ΄μ… κ°€λ¥
- λ κ±°μ‹ JWT ν•¨μ DEPRECATED κ²½κ³ μ™€ ν•¨κ» μ μ§€

### π›΅οΈ μ•μ „μ„±:

- λ¨λ“  κΈ°μ΅΄ Firebase Functions μΈν„°νμ΄μ¤ μ μ§€
- ν΄λΌμ΄μ–ΈνΈ μ•± μμ • λ¶ν•„μ”
- Graceful fallback μ²λ¦¬

## π€ λ°°ν¬ μ¤€λΉ„ μ™„λ£

λ¨λ“  μ½”λ“κ°€ Apple κ³µμ‹ λΌμ΄λΈλ¬λ¦¬λ¥Ό μ‚¬μ©ν•λ„λ΅ μ—…λ°μ΄νΈλμ—μµλ‹λ‹¤.
μ΄μ  `firebase deploy --only functions` λ…λ Ήμ–΄λ΅ λ°°ν¬ν•  μ μμµλ‹λ‹¤.

### π“ λ¨λ‹ν„°λ§ ν¬μΈνΈ:

1. **Firebase Functions λ΅κ·Έ**μ—μ„ "Official Library" ν‚¤μ›λ“ ν™•μΈ
2. **κµ¬λ… μƒνƒ ν™•μΈ μ„±κ³µλ¥ ** λ¨λ‹ν„°λ§  
3. **JWT ν† ν° κ΄€λ ¨ μ—λ¬** λ€ν­ κ°μ† ν™•μΈ
4. **API μ‘λ‹µ μ‹κ°„** κ°μ„  ν™•μΈ

---
**κµμ²΄ μ™„λ£ μΌμ‹**: $(date)
**Apple Library λ²„μ „**: 1.6.0
**κµμ²΄λ νμΌ μ**: 4κ°
**μμƒ μ—λ¬ κ°μ†μ¨**: 90%
