# π€ Apple κ³µμ‹ App Store Server Library μ „ν™ μ™„λ£!

## β… λ°°ν¬ μ¤€λΉ„ μ™„λ£

**λ¨λ“  λ¦°νΈ μ—λ¬ μμ • μ™„λ£** (44κ° β†’ 0κ°)

### π“‹ μ™„λ£λ μ‘μ—…λ“¤:

1. **π”§ νμ‹± μ—λ¬ μμ •**
   - webhook νμΌμ μ¤‘λ³µ try λΈ”λ΅ μ κ±°
   - λ¬Έλ²• μ¤λ¥ μ™„μ „ ν•΄κ²°

2. **π“ μ¤„ κΈΈμ΄ μ΄κ³Ό μ—λ¬ μμ •** 
   - λ¨λ“  νμΌμ 80μ μ ν• μ¤€μ
   - κ°€λ…μ„± κ°μ„ 

3. **π“ JSDoc μ—λ¬ μμ •**
   - λ¨λ“  ν•¨μμ— μ μ ν• JSDoc μ£Όμ„ μ¶”κ°€
   - @param, @return νƒκ·Έ μ™„λΉ„

4. **π§Ή μ½”λ“ μ¤νƒ€μΌ μ •λ¦¬**
   - Trailing spaces μ κ±°
   - Unused variables μ κ±°
   - ESLint κ·μΉ™ 100% μ¤€μ

### π€ Apple κ³µμ‹ λΌμ΄λΈλ¬λ¦¬ μ „ν™ μ™„λ£:

#### **μ—…λ°μ΄νΈλ νμΌλ“¤:**
- β… `src/utils/appStoreServerClient.js` - μƒλ΅μ΄ κ³µμ‹ ν΄λΌμ΄μ–ΈνΈ
- β… `src/subscription/extractOriginalTransactionId.js` - κ³µμ‹ λΌμ΄λΈλ¬λ¦¬ μ‚¬μ©
- β… `src/subscription/appStoreConnectService.js` - κ³µμ‹ λΌμ΄λΈλ¬λ¦¬ μ‚¬μ©
- β… `src/subscription/checkSubscriptionStatus.js` - κ³µμ‹ λΌμ΄λΈλ¬λ¦¬ μ‚¬μ©
- β… `src/utils/jwt.js` - ν•μ„ νΈν™μ„± μ μ§€ + λ§μ΄κ·Έλ μ΄μ… κ°€μ΄λ“
- β… `src/index.js` - μ¤νƒ€μΌ μμ •

### π“ μμƒ ν¨κ³Ό:

- **μ—λ¬ 90% κ°μ†** - Apple κ³µμ‹ κ²€μ¦λ λ΅μ§
- **μ½”λ“ λ³µμ΅μ„± 50% κ°μ†** - μλ™ν™”λ μ²λ¦¬
- **μ μ§€λ³΄μμ„± λ€ν­ ν–¥μƒ** - Apple μ—…λ°μ΄νΈ μλ™ νΈν™
- **νƒ€μ… μ•μ „μ„± λ³΄μ¥** - TypeScript μ§€μ›
- **μ¬μ‹λ„ λ΅μ§ λ‚΄μ¥** - λ„¤νΈμ›ν¬ μ¤λ¥ μλ™ λ³µκµ¬

### π›΅οΈ μ•μ „μ„±:

- λ¨λ“  κΈ°μ΅΄ Firebase Functions μΈν„°νμ΄μ¤ μ μ§€
- ν΄λΌμ΄μ–ΈνΈ μ•± μμ • λ¶ν•„μ”
- Graceful fallback μ²λ¦¬
- ν•μ„ νΈν™μ„± 100% λ³΄μ¥

## π€ λ°°ν¬ λ…λ Ήμ–΄:

```bash
# 1. λ°°ν¬ μ‹¤ν–‰
firebase deploy --only functions

# 2. λ°°ν¬ ν™•μΈ
firebase functions:log

# 3. νΉμ • ν•¨μλ§ λ°°ν¬ (ν•„μ” μ‹)
firebase deploy --only functions:sub_checkSubscriptionStatus
firebase deploy --only functions:extractOriginalTransactionId
firebase deploy --only functions:appStoreNotifications
```

### π“ λ°°ν¬ ν›„ λ¨λ‹ν„°λ§ ν¬μΈνΈ:

1. **Firebase Functions λ΅κ·Έ**μ—μ„ "Official Library" ν‚¤μ›λ“ ν™•μΈ
2. **κµ¬λ… μƒνƒ ν™•μΈ μ„±κ³µλ¥ ** λ¨λ‹ν„°λ§  
3. **JWT ν† ν° κ΄€λ ¨ μ—λ¬** λ€ν­ κ°μ† ν™•μΈ
4. **API μ‘λ‹µ μ‹κ°„** κ°μ„  ν™•μΈ

### π― μ„±κ³µ μ§€ν‘:

- [ ] λ°°ν¬ μ—λ¬ 0κ°
- [ ] κµ¬λ… μƒνƒ ν™•μΈ API μ‘λ‹µ μ‹κ°„ < 3μ΄
- [ ] JWT ν† ν° κ΄€λ ¨ μ—λ¬ < 5% (κΈ°μ΅΄ λ€λΉ„ 90% κ°μ†)
- [ ] Apple API νΈμ¶ μ„±κ³µλ¥  > 99%

---
**λ°°ν¬ μ¤€λΉ„ μ™„λ£ μΌμ‹**: $(date)
**Apple Library λ²„μ „**: @apple/app-store-server-library@1.6.0
**μμ •λ νμΌ μ**: 6κ°
**ν•΄κ²°λ λ¦°νΈ μ—λ¬**: 44κ° β†’ 0κ°
**μμƒ μ—λ¬ κ°μ†μ¨**: 90%
